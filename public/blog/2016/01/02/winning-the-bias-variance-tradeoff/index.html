
<!DOCTYPE html>


<html class="no-js" lang="en">
<head>
<meta charset="utf-8">
<title>Winning the bias-variance tradeoff - Polina Soshnin</title>
<meta name="author" content="Julia Evans">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="description" content="Winning the bias-variance tradeoff">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="canonical" href="https://jvns.ca/blog/2016/01/02/winning-the-bias-variance-tradeoff/">
<link href="/favicon.ico" rel="icon">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
<link href="/atom.xml" rel="alternate" title="Julia Evans" type="application/atom+xml">
 
<link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='https://fonts.googleapis.com/css?family=Montserrat:700,400' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Alegreya:400,900,700' rel='stylesheet' type='text/css'>
</head>
<body>
<div id="wrap">
<header role="banner">
<hgroup>
<h1><a href="/">Polina Soshnin</a></h1>
</hgroup>
<ul class="header-links">
<span><li><a href="/about">About</a></li>
<li><a href="/projects">Projects</a></li></span>
    <li><a href="https://github.com/polinadotio">Github</a></li></span>
    <li><a href="https://www.linkedin.com/in/polinasoshnin">LinkedIn</a></li></span>
</ul>
</header>
<nav role="navigation" class="header-nav"><ul class="main-navigation">
<li><a href="/categories/favorite/">Favorites</a></li>
<li><a href="/zines">Zines</a></li>
</ul>
</nav>
<div id="main">
<div id="content">

<div>
<article class="hentry" role="article">
<header>
<h1 class="entry-title">Winning the bias-variance tradeoff</h1>

<div class="post-tags">
  
</div>
<p class="meta">
<time datetime="2016-01-02T13:18:46" pubdate data-updated="true"></time>
</p>
</header>
<div class="entry-content">
     

<p>Machine learning is a strange mix of math and weird heuristics. When I started studying machine learning, I was SO FRUSTRATED. Everything was &ldquo;well it works in practice&rdquo; and so little of it was math. I was a pure math major at the time, so arguments like &ldquo;well it works in practice&rdquo; made me REALLY MAD.</p>

<p>I&rsquo;d kind of given up on having a better theoretical understanding of machine learning. It was working really well in practice for me, after all! But then I met the bias-variance decomposition.</p>

<p>The bias-variance decomposition is a small piece of math that actually explains why some things in machine learning work!</p>

<div align="center">
<img src="/images/ml-feelings.jpg" width="300px">

<p>
<small>
my feelings about machine learning in a picture
</small>
</p>
</div>

<p>The bias-variance decomposition gives you a framework for how to think about model error and overfitting, and it explains why techniques like model ensembles and ridge regression result in lower error (the tradeoff is a tradeoff you can WIN). I finally learned about it last week and it felt life-changing. I think it&rsquo;s going to help me build better models, and it can help you too!</p>

<p>I&rsquo;ve annotated each section by whether it&rsquo;s math or whether it a &ldquo;works in practice&rdquo; heuristic (aka bullshit, but useful bullshit).</p>

<h3 id="bias-and-variance-math">Bias and variance (math)</h3>

<p>I first took a machine learning class in 2011. I only understood what bias and variance were last week, after reading <a href="http://www-bcf.usc.edu/~gareth/ISL/">An Introduction to Statistical Learning</a>, which is an EXCELLENT book, along with <a href="http://statweb.stanford.edu/~tibs/ElemStatLearn/">its more advanced companion</a>. Here&rsquo;s the story. I&rsquo;m going to be a bit handwavy with the theorems &amp; definitions through all of this, because the sections in those books are excellent and they&rsquo;re free online PDFs. Please go there if you need more rigor! I&rsquo;ll do my best to be reasonably clear.</p>

<p><strong>The setup</strong>: Suppose we have all of the possible training data for a model, and a model training method (like linear regression). We&rsquo;re going to look at what happens for a specific training point $$x_0$$.</p>

<p>Take a list of all training sets, and for each training set train a model $$M$$. Then we can look at the distribution of predictions $$M(x_0)$$ for each model. (see <a href="https://en.wikipedia.org/wiki/Statistical_learning_theory">Statistical learning theory</a> if you&rsquo;re super interested in the theoretical foundations for machine learning)</p>

<p>The best case scenario: For every model we train, $$M(x_0)$$ is always the same no matter what training set we picked, and always correct. The worst case scenario: it&rsquo;s always changing and always totally wrong. In reality: you have some probability distribution of predicted values.</p>

<p><strong>Variance</strong> is the variance of this probability distribution of predictions across all models (how different are the values from each other?)</p>

<p>This is incredibly important: if every model you train makes totally different predictions, you&rsquo;re in big trouble! Those predictions are definitely not correct.</p>

<p><strong>On variance &amp; overfitting:</strong> I keep hearing that high variance and overfitting are the same thing, and it makes sense to me. Overfitting is an idea, not a well-defined quantity, and if your modelling method gives you completely different results for every set of training data &ndash; I&rsquo;d call that overfit. So I&rsquo;m okay defining overfitting and variance to be the same thing.</p>

<p><strong>Measuring variance</strong>: Variance is cool because you have some prayer of approximating it for your actual models! You could imagine training your model on different training subsets, and seeing how different the predictions are.</p>

<p><strong>Bias</strong> is the difference between the mean of this probability distribution and the actual correct value. Do the models on average predict the right thing for that point?</p>

<p>Worst case: If you have a relationship that is totally nonlinear, and you try to use a linear model, your bias is definitely going to be high. It&rsquo;s impossible to fit a correct model!</p>

<p>Best case: If you have a true linear relationship, and you fit a linear model with least squares regression, your bias for every point is <strong>zero</strong>. 0! unbiased! On average you&rsquo;re always going to be exactly correct. But that doesn&rsquo;t mean least squares regression is the best method! We&rsquo;ll explain why in the next section =D =D</p>

<p><strong>On complexity &amp; bias</strong>: People say that more complex models (with more parameters) have lower bias. As far as I can tell this is something that&rsquo;s likely to be true but does not have any math behind it. If there is math that says this is true I would <a href="https://twitter.com/b0rk">love to know</a>.</p>

<p><strong>Measuring bias</strong>: I have no idea how to measure bias in the real world. My impression is people mostly guess at whether a model&rsquo;s bias is high or low.</p>

<h3 id="the-bias-variance-decomposition-math">The bias-variance decomposition (math)</h3>

<p>This is a theorem that you can find in <a href="http://www-bcf.usc.edu/~gareth/ISL/">An Introduction to Statistical Learning</a>. This is math so it will never let us down ‚ù§.  It basically says that the error at a point is the</p>

<pre><code>Err(x) = Bias^2 + Variance + Irreducible Error
</code></pre>

<p><strong>The actual theorem statement</strong></p>

<p>Denote the variable we are trying to predict as $$Y$$ and our covariates as $$X$$. Assume that there is a relationship relating one to the other such as $$Y=f(X)+\epsilon$$ where the error term $$\epsilon$$ is normally distributed with a mean of zero like so: $$\epsilon \sim N(0,\sigma_\epsilon)$$.</p>

<p>We may estimate a model $$\hat{f}(X)$$ of $$f(X)$$ using linear regressions or another modeling technique. In this case, the expected squared prediction error at a point $$x$$ is:</p>

<p>$$Err(x)=E[(Y - \hat{f}(x))^2]$$</p>

<p>This error may then be decomposed into bias and variance components:</p>

<p>$$Err(x)=(E[\hat{f}(x)] - f(x))^2+E[\hat{f}(x) - E[\hat{f}(x)]]^2+\sigma^2\epsilon$$</p>

<p>or in other words</p>

<pre><code>Err(x) = Bias^2 + Variance + Irreducible Error
</code></pre>

<p>This is <strong>awesome</strong>. It means that every time we have error, it&rsquo;s either because of bias or because of variance.</p>

<p><strong>Heuristic warning</strong>: From now on, I&rsquo;m going to talk about the bias and variance of a model. If you&rsquo;ve reading carefully, you&rsquo;ll notice that this doesn&rsquo;t quite make sense: we&rsquo;ve only defined bias and variance for a modelling method and a specific input to that model (we took the variance of $$M(x_0)$$ over all models $$M$$). All the arguments we&rsquo;re going to make from now on are heuristic and not math, so we&rsquo;re going to start being sloppy with the math.</p>

<h3 id="the-bias-variance-tradeoff-heuristic">The bias-variance tradeoff (heuristic)</h3>

<p>Now we get to the cool part: the bias-variance tradeoff! As with many cool things in machine learning, the theoretical foundation here is a little shaky.</p>

<p>There&rsquo;s no math reason I know of you have to have a tradeoff between bias and variance (if you know one, <a href="https//twitter.com/b0rk">tell me!</a>). In an ideal world, you could just train a model with low variance and low bias and win at life.</p>

<p>In the real world, however, we do not have magical model training methods :(. And often what people observe in practice is that as you increase the complexity of a kind of model (by training deeper decision trees, for instance), the bias decreases and the variance increases. This is the &ldquo;bias-variance tradeoff&rdquo;!</p>

<p>But just knowing that isn&rsquo;t so useful. So what?</p>

<p>It turns out that thinking model performance in terms of a tradeoff between bias and variance can help us build better models!</p>

<h3 id="winning-the-bias-variance-tradeoff-ensembles">Winning the bias-variance tradeoff: Ensembles!</h3>

<p>The whole reason we&rsquo;re talking about this is so we can build machine learning models with less errors. Machine learning people frequently use ensembles: take 10 or 100 models and average their results together to get a better model. For the longest time I had no idea why it worked! Here&rsquo;s why.</p>

<p>Ensembles are based on math! In general, if I have $$n$$ independent samples from a probability distribution with variance $$\sigma$$ and mean $$\mu$$, and I average them, then the new mean is the same ($$\mu$$), but the new variance will be reduced! ($$\frac{\sigma}{n}$$).</p>

<p>In general if my samples have some correlation $$\rho$$, the reduction in variance depends on the correlation (a low correlation means a big reduction in variance)! This is all math.</p>

<p>Now, suppose you have a way to generate a model which has low bias and high variance. The canonical example of this is supposedly a deep decision tree, though I&rsquo;m not aware of any math showing that decision trees have low bias.</p>

<p>Then if you can &ldquo;average&rdquo; 100 models generated in the same way, then your final model should have the same bias (mean), but lower variance! Because of the bias-variance decomposition, this means that it&rsquo;s BETTER (the overall error is lower!). Yay! Further, the amount of variance reduction you get depends on the correlation between the 100 models.</p>

<p>This is why random forests work! Random forests take a bunch of decision trees (low bias, high variance), average them (lower variance!). And they use an extra trick (select a random subset of features when splitting) to reduce the correlation between the trees (extra lower variance!!!).</p>

<p>Understanding why ensembles work is awesome &ndash; it means that if an ensemble method isn&rsquo;t helping you, you can understand why! It&rsquo;s probably because the correlation between the models in your ensemble is too high.</p>

<h3 id="winning-the-bias-variance-tradeoff-regularization">Winning the bias-variance tradeoff: Regularization!</h3>

<p>And there&rsquo;s a second way to win! I honestly don&rsquo;t really understand <a href="https://en.wikipedia.org/wiki/Regularization_(mathematics)">regularization</a> yet, so I&rsquo;m not going to try to explain the math at all (try <a href="http://statweb.stanford.edu/~tibs/ElemStatLearn/">Elements of Statistical Learning</a> instead).</p>

<p>But I can talk about the idea for a minute! First, I want to tell you about the <a href="https://en.wikipedia.org/wiki/James%E2%80%93Stein_estimator">James‚ÄìStein estimator</a><sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup>. Suppose you&rsquo;re trying to estimate the mean of a bunch of random vectors. The normal (unbiased!) way to estimate the true mean is to, well, take the mean of those random vectors! Awesome. You might expect that you can&rsquo;t do better. BUT YOU CAN. The James-Stein estimator is a way to estimate the mean that gives you lower error. It&rsquo;s a biased estimator (so on average it won&rsquo;t give you a correct result), but its error is lower. This is amazing.</p>

<p>Model regularization is has the same effect &ndash; basically you solve a different optimization where you constrain the parameters you&rsquo;re allowed to use. You end up increasing your bias and lowering the variance. And  then you can end up winning and ending up with a lower overall error, if you&rsquo;ve lowered the variance by more than you increased the bias!</p>

<p>Since I don&rsquo;t understand how regularization works yet and have never used it, I also don&rsquo;t know how to debug regularization (if you try regularization and it doesn&rsquo;t making your model better, how can you tell why not?!). If you know how to debug regularization I&rsquo;d love to know.</p>

<h3 id="learning-some-math">learning some math = ‚ù§</h3>

<p>I still find it kind of frustrating how heuristic most of these arguments are. Machine learning is an empirical game! But knowing a little more of the math makes me feel a little more comfortable. Not knowing how machine learning methods work means I can&rsquo;t debug them, and that means I can&rsquo;t be amazing. which obviously isn&rsquo;t acceptable :D</p>

<p>If you know more math that helps you debug your machine learning models and explain their performance, please tell me!</p>

<p><small>Thanks to Max McCrea for reading this, and for Stephen Tu for helping me understand the math here and introducing me to statistical learning theory.</small></p>

<p>{% include katex_render.html %}</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">Do you know about the <a href="http://www.amazon.ca/Princeton-Companion-Mathematics-Timothy-Gowers/dp/0691118809">Princeton Companion to Mathematics</a>? It&rsquo;s literally a book that will explain EVERYTHING IN MATH TO YOU. It&rsquo;s so fun, super well-written, and it taught me about the James-Stein estimator. It&rsquo;s written at a level so that someone with a pure math degree should find it approachable (so, it&rsquo;s perfect for me &lt;3).
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>

</div>
<footer>
<div class="sharing">
<a href="http://twitter.com/share" class="twitter-share-button" data-url="https://jvns.ca/blog/2016/01/02/winning-the-bias-variance-tradeoff/" data-via="b0rk" data-counturl="https://jvns.ca/blog/2016/01/02/winning-the-bias-variance-tradeoff/">Tweet</a>
</div>
<p class="meta">
   
    <a class="basic-alignment left" href="https://jvns.ca/blog/2016/01/03/java-isnt-slow/" title="Previous Post: Java isn&#39;t slow">Java isn&#39;t slow</a>
  
   
    <a class="basic-alignment right" href="https://jvns.ca/blog/2015/12/31/surviving-meetings-while-remote/" title="Previous Post: Surviving meetings while remote">Surviving meetings while remote</a>
  
</p>
</footer>
</article>
</div>

</div>
</div>
<nav role="navigation" class="footer-nav"> <a href="/">Archives</a>
</nav>
<footer role="contentinfo"><span class="credit">&copy; 2016 Polina Soshnin.
</footer>
</div>
</body>
</html>

